#!/usr/bin/zsh
CURRENT_BRANCH=$(git rev-parse --abbrev-ref HEAD)
REMOTE_BRANCH=$(ssh shopstage.textalk.se "cd /www/andreasstage.textalk.se/ && git rev-parse --abbrev-ref HEAD")

notify-send "Syncing..."
echo "Syncing to stage..."
gr-sync shopstage.textalk.se /www/andreasstage.textalk.se/ && \
ssh shopstage.textalk.se "cd /www/andreasstage.textalk.se/build/fastmulang/ && php fastmulang.php deploy sv Admin" && \
notify-send "Synced changes" && \
if [ "$CURRENT_BRANCH" != "$REMOTE_BRANCH" ]; then echo "\033[1;36mWarning! Local branch and remote branch do not match!"; exit 1; fi
